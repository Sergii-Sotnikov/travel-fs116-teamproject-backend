tags:
  - Users
summary: Update current user's profile
operationId: patchMe
description: Update profile fields (name, description) and optionally upload a new avatar image.
security:
  - bearerAuth: []

requestBody:
  required: true
  content:
    multipart/form-data:
      schema:
        type: object
        properties:
          name:
            type: string
            maxLength: 100
            description: User's display name
            example: Test8
          description:
            type: string
            maxLength: 1000
            description: User's bio/description
            example: Hello Sergiy
          avatar:
            type: string
            format: binary
            description: Avatar image file (JPG, PNG, WebP, max 5MB)
        minProperties: 1
        description: At least one field (name, description) or file (avatar) must be provided

responses:
  '200':
    description: Profile updated successfully
    content:
      application/json:
        schema:
          type: object
          required: [status, message, data]
          properties:
            status:
              type: integer
              example: 200
            message:
              type: string
              example: Profile updated successfully
            data:
              $ref: '../../../components/schemas/user.yaml'
        examples:
          success:
            value:
              status: 200
              message: Profile updated successfully
              data:
                _id: 69134925a9c11877caa26fd9
                name: Test8
                email: test8@example.com
                avatarUrl: https://res.cloudinary.com/dcyt4kr5s/image/upload/v1762684805/avatars/ycozq7nun3lbze83tjsk.png
                articlesAmount: 1
                description: Hello Sergiy
                createdAt: 2025-11-11T14:33:09.641Z
                updatedAt: 2025-11-11T15:45:22.123Z

  '400':
    description: Invalid request (missing fields or invalid file)
    content:
      application/json:
        schema:
          type: object
          required: [status, message, data]
          properties:
            status:
              type: integer
              example: 400
            message:
              type: string
              example: BadRequestError
            data:
              type: object
              example:
                name: BadRequestError
                message: Invalid request body
                details:
                  - At least one field is required (name, description, or avatar)

  '401':
    $ref: '../../../components/responses/401.yaml'
  '413':
    description: Payload Too Large (file exceeds 5MB)
  '415':
    description: Unsupported Media Type
  '500':
    $ref: '../../../components/responses/500.yaml'
